
rethinkdb:
  image: rethinkdb
  hostname: rdbmaster
  volumes:
      - restangulask_rdbdata:/data

searchindex:
  image: elasticsearch
  hostname: elastic
  environment:
      ES_HEAP_SIZE: 2g
      # curl http://el:9200/_nodes/process?pretty
      # http://stackoverflow.com/a/18152957/2114395
      #https://www.loggly.com/blog/nine-tips-configuring-elasticsearch-for-high-performance/
  volumes:
      - restangulask_elasticdata:/usr/share/elasticsearch/data
      - ../containers/elastic.confs:/usr/share/elasticsearch/config

uploadsdata:
  image: busybox
  command: echo 'launched'
  volumes:
    # Upload directory
    - ../uploads:/uploads

custombe:
  extends:
    file: docker-compose.yml
    service: backend
  links:
    - rethinkdb:rdb
    - searchindex:el
  volumes_from:
    - uploadsdata

customfe:
  extends:
    file: docker-compose.yml
    service: frontend
  links:
    - custombe:myapi
  volumes_from:
    - htmlfiles
    - uploadsdata
